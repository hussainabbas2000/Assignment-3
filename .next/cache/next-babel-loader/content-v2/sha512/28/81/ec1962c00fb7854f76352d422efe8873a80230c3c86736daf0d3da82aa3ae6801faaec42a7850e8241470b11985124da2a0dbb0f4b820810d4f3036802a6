{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Hussain\\\\Desktop\\\\f\\\\app\\\\pages\\\\p\\\\[productId].js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useContext, useState, useEffect, useRef } from 'react';\nimport clsx from 'clsx';\nimport qs from 'qs';\nimport useLazyState from 'react-storefront/hooks/useLazyState';\nimport Breadcrumbs from 'react-storefront/Breadcrumbs';\nimport CmsSlot from 'react-storefront/CmsSlot';\nimport MediaCarousel from 'react-storefront/carousel/MediaCarousel';\nimport PWAContext from 'react-storefront/PWAContext';\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Hidden from \"@material-ui/core/Hidden\";\nimport Button from \"@material-ui/core/Button\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Row from 'react-storefront/Row';\nimport { Hbox } from 'react-storefront/Box';\nimport Label from 'react-storefront/Label';\nimport Rating from 'react-storefront/Rating';\nimport get from 'lodash/get';\nimport fetch from 'react-storefront/fetch';\nimport { fetchLatest, StaleResponseError } from 'react-storefront/utils/fetchLatest';\nimport SessionContext from 'react-storefront/session/SessionContext';\nimport AddToCartConfirmation from '../../components/product/AddToCartConfirmation';\nimport SuggestedProducts from '../../components/product/SuggestedProducts';\nimport Lazy from 'react-storefront/Lazy';\nimport TabPanel from 'react-storefront/TabPanel';\nimport QuantitySelector from 'react-storefront/QuantitySelector';\nimport ProductOptionSelector from 'react-storefront/option/ProductOptionSelector';\nimport fetchFromAPI from 'react-storefront/props/fetchFromAPI';\nimport createLazyProps from 'react-storefront/props/createLazyProps';\nconst fetchVariant = fetchLatest(fetch);\n\nconst useDidMountEffect = (func, deps) => {\n  const didMount = useRef(false);\n  useEffect(() => {\n    if (didMount.current) {\n      func();\n    } else {\n      didMount.current = true;\n    }\n  }, deps);\n};\n\nconst styles = theme => ({\n  carousel: {\n    [theme.breakpoints.down('xs')]: {\n      margin: theme.spacing(0, -2),\n      width: '100vw'\n    }\n  },\n  lightboxCarousel: {\n    [theme.breakpoints.down('xs')]: {\n      margin: 0,\n      width: '100%'\n    }\n  },\n  confirmation: {\n    padding: '2px 0'\n  },\n  dockedSnack: {\n    [theme.breakpoints.down('xs')]: {\n      left: '0',\n      bottom: '0',\n      right: '0'\n    }\n  },\n  docked: {\n    [theme.breakpoints.down('xs')]: {\n      fontSize: theme.typography.subtitle1.fontSize,\n      padding: `${theme.spacing(2)}px`,\n      position: 'fixed',\n      left: 0,\n      bottom: 0,\n      width: '100%',\n      zIndex: 10,\n      borderRadius: '0'\n    }\n  },\n  noShadow: {\n    [theme.breakpoints.down('xs')]: {\n      boxShadow: 'none'\n    }\n  }\n});\n\nconst useStyles = makeStyles(styles);\nconst Product = /*#__PURE__*/React.memo(lazyProps => {\n  const theme = useTheme();\n  const {\n    0: confirmationOpen,\n    1: setConfirmationOpen\n  } = useState(false);\n  const {\n    0: addToCartInProgress,\n    1: setAddToCartInProgress\n  } = useState(false);\n  const [state, updateState] = useLazyState(lazyProps, {\n    pageData: {\n      quantity: 1,\n      carousel: {\n        index: 0\n      }\n    }\n  });\n  const classes = useStyles();\n  const product = get(state, 'pageData.product') || {};\n  const color = get(state, 'pageData.color') || {};\n  const size = get(state, 'pageData.size') || {};\n  const quantity = get(state, 'pageData.quantity');\n  const {\n    actions\n  } = useContext(SessionContext);\n  const {\n    loading\n  } = state; // This is provided when <ForwardThumbnail> is wrapped around product links\n\n  const {\n    thumbnail\n  } = useContext(PWAContext); // Adds an item to the cart\n\n  const handleSubmit = async event => {\n    event.preventDefault(); // prevent the page location from changing\n\n    setAddToCartInProgress(true); // disable the add to cart button until the request is finished\n\n    try {\n      // send the data to the server\n      await actions.addToCart({\n        product,\n        quantity,\n        color: color.id,\n        size: size.id\n      }); // open the confirmation dialog\n\n      setConfirmationOpen(true);\n    } finally {\n      // re-enable the add to cart button\n      setAddToCartInProgress(false);\n    }\n  };\n\n  const header = /*#__PURE__*/_jsxDEV(Row, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      component: \"h1\",\n      gutterBottom: true,\n      children: product ? product.name : /*#__PURE__*/_jsxDEV(Skeleton, {\n        style: {\n          height: '1em'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 35\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Hbox, {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        style: {\n          marginRight: theme.spacing(2)\n        },\n        children: product.priceText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Rating, {\n        value: product.rating,\n        reviewCount: 10\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this); // Fetch variant data upon changing color or size options\n\n\n  useDidMountEffect(() => {\n    const query = qs.stringify({\n      color: color.id,\n      size: size.id\n    }, {\n      addQueryPrefix: true\n    });\n    fetchVariant(`/api/p/${product.id}${query}`).then(res => res.json()).then(data => {\n      return updateState(_objectSpread(_objectSpread({}, state), {}, {\n        pageData: _objectSpread(_objectSpread({}, state.pageData), data.pageData)\n      }));\n    }).catch(e => {\n      if (!StaleResponseError.is(e)) {\n        throw e;\n      }\n    });\n  }, [color.id, size.id]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Breadcrumbs, {\n      items: !loading && state.pageData.breadcrumbs\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      maxWidth: \"lg\",\n      style: {\n        paddingTop: theme.spacing(2)\n      },\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        method: \"post\",\n        \"action-xhr\": \"/api/cart\",\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 4,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 5,\n            children: [/*#__PURE__*/_jsxDEV(Hidden, {\n              implementation: \"css\",\n              smUp: true,\n              children: header\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(MediaCarousel, {\n              className: classes.carousel,\n              lightboxClassName: classes.lightboxCarousel,\n              thumbnail: thumbnail.current,\n              height: \"100%\",\n              media: color.media || product && product.media\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            sm: 6,\n            md: 7,\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 4,\n              children: [/*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: [/*#__PURE__*/_jsxDEV(Hidden, {\n                  implementation: \"css\",\n                  xsDown: true,\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      paddingBottom: theme.spacing(1)\n                    },\n                    children: header\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 175,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 174,\n                  columnNumber: 19\n                }, this), product ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(Hbox, {\n                    style: {\n                      marginBottom: 10\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      children: \"COLOR: \"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 180,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                      children: color.text\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 181,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 179,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(ProductOptionSelector, {\n                    options: product.colors,\n                    value: color,\n                    onChange: value => updateState(_objectSpread(_objectSpread({}, state), {}, {\n                      pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                        color: value\n                      })\n                    })),\n                    strikeThroughDisabled: true,\n                    optionProps: {\n                      showLabel: false\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 183,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n                    style: {\n                      height: 14,\n                      marginBottom: theme.spacing(2)\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 197,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Hbox, {\n                    children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 199,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 200,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 201,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: product ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(Hbox, {\n                    style: {\n                      marginBottom: 10\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(Label, {\n                      children: \"SIZE: \"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 210,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                      children: size.text\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 211,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 209,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(ProductOptionSelector, {\n                    options: product.sizes,\n                    value: size,\n                    strikeThroughDisabled: true,\n                    onChange: value => updateState(_objectSpread(_objectSpread({}, state), {}, {\n                      pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                        size: value\n                      })\n                    }))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 213,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n                    style: {\n                      height: 14,\n                      marginBottom: theme.spacing(2)\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 224,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(Hbox, {\n                    children: [/*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 226,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 227,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Skeleton, {\n                      style: {\n                        height: 48,\n                        width: 48,\n                        marginRight: 10\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 228,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 225,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 223,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: /*#__PURE__*/_jsxDEV(Hbox, {\n                  children: [/*#__PURE__*/_jsxDEV(Label, {\n                    children: \"QTY:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 235,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(QuantitySelector, {\n                    value: quantity,\n                    onChange: value => updateState(_objectSpread(_objectSpread({}, state), {}, {\n                      pageData: _objectSpread(_objectSpread({}, state.pageData), {}, {\n                        quantity: value\n                      })\n                    }))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 236,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 12,\n                children: [/*#__PURE__*/_jsxDEV(Button, {\n                  type: \"submit\",\n                  variant: \"contained\",\n                  color: \"primary\",\n                  size: \"large\",\n                  \"data-th\": \"add-to-cart\",\n                  className: clsx(classes.docked, classes.noShadow),\n                  disabled: addToCartInProgress,\n                  children: \"Add to Cart\"\n                }, \"button\", false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(AddToCartConfirmation, {\n                  open: confirmationOpen,\n                  setOpen: setConfirmationOpen,\n                  product: product,\n                  color: color,\n                  size: size,\n                  quantity: quantity,\n                  price: product.priceText\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsxDEV(TabPanel, {\n            children: [/*#__PURE__*/_jsxDEV(CmsSlot, {\n              label: \"Description\",\n              children: product.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(CmsSlot, {\n              label: \"Specs\",\n              children: product.specs\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          children: /*#__PURE__*/_jsxDEV(Lazy, {\n            style: {\n              minHeight: 285\n            },\n            children: /*#__PURE__*/_jsxDEV(SuggestedProducts, {\n              product: product\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n});\nProduct.getInitialProps = createLazyProps(fetchFromAPI);\nexport default Product;","map":{"version":3,"sources":["C:/Users/Hussain/Desktop/f/app/pages/p/[productId].js"],"names":["React","useContext","useState","useEffect","useRef","clsx","qs","useLazyState","Breadcrumbs","CmsSlot","MediaCarousel","PWAContext","makeStyles","useTheme","Row","Hbox","Label","Rating","get","fetch","fetchLatest","StaleResponseError","SessionContext","AddToCartConfirmation","SuggestedProducts","Lazy","TabPanel","QuantitySelector","ProductOptionSelector","fetchFromAPI","createLazyProps","fetchVariant","useDidMountEffect","func","deps","didMount","current","styles","theme","carousel","breakpoints","down","margin","spacing","width","lightboxCarousel","confirmation","padding","dockedSnack","left","bottom","right","docked","fontSize","typography","subtitle1","position","zIndex","borderRadius","noShadow","boxShadow","useStyles","Product","memo","lazyProps","confirmationOpen","setConfirmationOpen","addToCartInProgress","setAddToCartInProgress","state","updateState","pageData","quantity","index","classes","product","color","size","actions","loading","thumbnail","handleSubmit","event","preventDefault","addToCart","id","header","name","height","marginRight","priceText","rating","query","stringify","addQueryPrefix","then","res","json","data","catch","e","is","breadcrumbs","paddingTop","media","paddingBottom","marginBottom","text","colors","value","showLabel","sizes","description","specs","minHeight","getInitialProps"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from 'react'\nimport clsx from 'clsx'\nimport qs from 'qs'\nimport useLazyState from 'react-storefront/hooks/useLazyState'\nimport Breadcrumbs from 'react-storefront/Breadcrumbs'\nimport CmsSlot from 'react-storefront/CmsSlot'\nimport MediaCarousel from 'react-storefront/carousel/MediaCarousel'\nimport PWAContext from 'react-storefront/PWAContext'\nimport { Container, Grid, Typography, Hidden, Button } from '@material-ui/core'\nimport { Skeleton } from '@material-ui/lab'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport Row from 'react-storefront/Row'\nimport { Hbox } from 'react-storefront/Box'\nimport Label from 'react-storefront/Label'\nimport Rating from 'react-storefront/Rating'\nimport get from 'lodash/get'\nimport fetch from 'react-storefront/fetch'\nimport { fetchLatest, StaleResponseError } from 'react-storefront/utils/fetchLatest'\nimport SessionContext from 'react-storefront/session/SessionContext'\nimport AddToCartConfirmation from '../../components/product/AddToCartConfirmation'\nimport SuggestedProducts from '../../components/product/SuggestedProducts'\nimport Lazy from 'react-storefront/Lazy'\nimport TabPanel from 'react-storefront/TabPanel'\nimport QuantitySelector from 'react-storefront/QuantitySelector'\nimport ProductOptionSelector from 'react-storefront/option/ProductOptionSelector'\nimport fetchFromAPI from 'react-storefront/props/fetchFromAPI'\nimport createLazyProps from 'react-storefront/props/createLazyProps'\n\nconst fetchVariant = fetchLatest(fetch)\n\nconst useDidMountEffect = (func, deps) => {\n  const didMount = useRef(false)\n  useEffect(() => {\n    if (didMount.current) {\n      func()\n    } else {\n      didMount.current = true\n    }\n  }, deps)\n}\n\nconst styles = theme => ({\n  carousel: {\n    [theme.breakpoints.down('xs')]: {\n      margin: theme.spacing(0, -2),\n      width: '100vw',\n    },\n  },\n  lightboxCarousel: {\n    [theme.breakpoints.down('xs')]: {\n      margin: 0,\n      width: '100%',\n    },\n  },\n  confirmation: {\n    padding: '2px 0',\n  },\n  dockedSnack: {\n    [theme.breakpoints.down('xs')]: {\n      left: '0',\n      bottom: '0',\n      right: '0',\n    },\n  },\n  docked: {\n    [theme.breakpoints.down('xs')]: {\n      fontSize: theme.typography.subtitle1.fontSize,\n      padding: `${theme.spacing(2)}px`,\n      position: 'fixed',\n      left: 0,\n      bottom: 0,\n      width: '100%',\n      zIndex: 10,\n      borderRadius: '0',\n    },\n  },\n  noShadow: {\n    [theme.breakpoints.down('xs')]: {\n      boxShadow: 'none',\n    },\n  },\n})\n\nconst useStyles = makeStyles(styles)\n\nconst Product = React.memo(lazyProps => {\n  const theme = useTheme()\n  const [confirmationOpen, setConfirmationOpen] = useState(false)\n  const [addToCartInProgress, setAddToCartInProgress] = useState(false)\n  const [state, updateState] = useLazyState(lazyProps, {\n    pageData: { quantity: 1, carousel: { index: 0 } },\n  })\n  const classes = useStyles()\n  const product = get(state, 'pageData.product') || {}\n  const color = get(state, 'pageData.color') || {}\n  const size = get(state, 'pageData.size') || {}\n  const quantity = get(state, 'pageData.quantity')\n  const { actions } = useContext(SessionContext)\n  const { loading } = state\n\n  // This is provided when <ForwardThumbnail> is wrapped around product links\n  const { thumbnail } = useContext(PWAContext)\n\n  // Adds an item to the cart\n  const handleSubmit = async event => {\n    event.preventDefault() // prevent the page location from changing\n    setAddToCartInProgress(true) // disable the add to cart button until the request is finished\n\n    try {\n      // send the data to the server\n      await actions.addToCart({\n        product,\n        quantity,\n        color: color.id,\n        size: size.id,\n      })\n\n      // open the confirmation dialog\n      setConfirmationOpen(true)\n    } finally {\n      // re-enable the add to cart button\n      setAddToCartInProgress(false)\n    }\n  }\n\n  const header = (\n    <Row>\n      <Typography variant=\"h6\" component=\"h1\" gutterBottom>\n        {product ? product.name : <Skeleton style={{ height: '1em' }} />}\n      </Typography>\n      <Hbox>\n        <Typography style={{ marginRight: theme.spacing(2) }}>{product.priceText}</Typography>\n        <Rating value={product.rating} reviewCount={10} />\n      </Hbox>\n    </Row>\n  )\n\n  // Fetch variant data upon changing color or size options\n  useDidMountEffect(() => {\n    const query = qs.stringify({ color: color.id, size: size.id }, { addQueryPrefix: true })\n    fetchVariant(`/api/p/${product.id}${query}`)\n      .then(res => res.json())\n      .then(data => {\n        return updateState({ ...state, pageData: { ...state.pageData, ...data.pageData } })\n      })\n      .catch(e => {\n        if (!StaleResponseError.is(e)) {\n          throw e\n        }\n      })\n  }, [color.id, size.id])\n\n  return (\n    <>\n      <Breadcrumbs items={!loading && state.pageData.breadcrumbs} />\n      <Container maxWidth=\"lg\" style={{ paddingTop: theme.spacing(2) }}>\n        <form onSubmit={handleSubmit} method=\"post\" action-xhr=\"/api/cart\">\n          <Grid container spacing={4}>\n            <Grid item xs={12} sm={6} md={5}>\n              <Hidden implementation=\"css\" smUp>\n                {header}\n              </Hidden>\n              <MediaCarousel\n                className={classes.carousel}\n                lightboxClassName={classes.lightboxCarousel}\n                thumbnail={thumbnail.current}\n                height=\"100%\"\n                media={color.media || (product && product.media)}\n              />\n            </Grid>\n            <Grid item xs={12} sm={6} md={7}>\n              <Grid container spacing={4}>\n                <Grid item xs={12}>\n                  <Hidden implementation=\"css\" xsDown>\n                    <div style={{ paddingBottom: theme.spacing(1) }}>{header}</div>\n                  </Hidden>\n                  {product ? (\n                    <>\n                      <Hbox style={{ marginBottom: 10 }}>\n                        <Label>COLOR: </Label>\n                        <Typography>{color.text}</Typography>\n                      </Hbox>\n                      <ProductOptionSelector\n                        options={product.colors}\n                        value={color}\n                        onChange={value =>\n                          updateState({ ...state, pageData: { ...state.pageData, color: value } })\n                        }\n                        strikeThroughDisabled\n                        optionProps={{\n                          showLabel: false,\n                        }}\n                      />\n                    </>\n                  ) : (\n                    <div>\n                      <Skeleton style={{ height: 14, marginBottom: theme.spacing(2) }}></Skeleton>\n                      <Hbox>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                      </Hbox>\n                    </div>\n                  )}\n                </Grid>\n                <Grid item xs={12}>\n                  {product ? (\n                    <>\n                      <Hbox style={{ marginBottom: 10 }}>\n                        <Label>SIZE: </Label>\n                        <Typography>{size.text}</Typography>\n                      </Hbox>\n                      <ProductOptionSelector\n                        options={product.sizes}\n                        value={size}\n                        strikeThroughDisabled\n                        onChange={value =>\n                          updateState({ ...state, pageData: { ...state.pageData, size: value } })\n                        }\n                      />\n                    </>\n                  ) : (\n                    <div>\n                      <Skeleton style={{ height: 14, marginBottom: theme.spacing(2) }}></Skeleton>\n                      <Hbox>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                        <Skeleton style={{ height: 48, width: 48, marginRight: 10 }}></Skeleton>\n                      </Hbox>\n                    </div>\n                  )}\n                </Grid>\n                <Grid item xs={12}>\n                  <Hbox>\n                    <Label>QTY:</Label>\n                    <QuantitySelector\n                      value={quantity}\n                      onChange={value =>\n                        updateState({ ...state, pageData: { ...state.pageData, quantity: value } })\n                      }\n                    />\n                  </Hbox>\n                </Grid>\n                <Grid item xs={12}>\n                  <Button\n                    key=\"button\"\n                    type=\"submit\"\n                    variant=\"contained\"\n                    color=\"primary\"\n                    size=\"large\"\n                    data-th=\"add-to-cart\"\n                    className={clsx(classes.docked, classes.noShadow)}\n                    disabled={addToCartInProgress}\n                  >\n                    Add to Cart\n                  </Button>\n                  <AddToCartConfirmation\n                    open={confirmationOpen}\n                    setOpen={setConfirmationOpen}\n                    product={product}\n                    color={color}\n                    size={size}\n                    quantity={quantity}\n                    price={product.priceText}\n                  />\n                </Grid>\n              </Grid>\n            </Grid>\n          </Grid>\n          <Grid item xs={12}>\n            <TabPanel>\n              <CmsSlot label=\"Description\">{product.description}</CmsSlot>\n              <CmsSlot label=\"Specs\">{product.specs}</CmsSlot>\n            </TabPanel>\n          </Grid>\n          <Grid item xs={12}>\n            <Lazy style={{ minHeight: 285 }}>\n              <SuggestedProducts product={product} />\n            </Lazy>\n          </Grid>\n        </form>\n      </Container>\n    </>\n  )\n})\n\nProduct.getInitialProps = createLazyProps(fetchFromAPI)\n\nexport default Product\n"]},"metadata":{},"sourceType":"module"}